/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var e={14385:function(e){"use strict";e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),t.hash&&(e+=t.hash),t.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(e)?'"'.concat(e,'"'):e):e}},44809:function(e,t){var n,r;n=function e(){var t,n="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n?n:{},r=!n.document&&!!n.postMessage,o=n.IS_PAPA_WORKER||!1,i={},s=0,a={};function c(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=b(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new h(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,t){var r=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<r){let t=this._config.newline;t||(i=this._config.quoteChar||'"',t=this._handle.guessLineEndings(e,i)),e=[...e.split(t).slice(r)].join(t)}this.isFirstChunk&&_(this._config.beforeFirstChunk)&&void 0!==(i=this._config.beforeFirstChunk(e))&&(e=i),this.isFirstChunk=!1,this._halted=!1,r=this._partialLine+e;var i=(this._partialLine="",this._handle.parse(r,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(e=i.meta.cursor,this._finished||(this._partialLine=r.substring(e-this._baseIndex),this._baseIndex=e),i&&i.data&&(this._rowCount+=i.data.length),r=this._finished||this._config.preview&&this._rowCount>=this._config.preview,o)n.postMessage({results:i,workerId:a.WORKER_ID,finished:r});else if(_(this._config.chunk)&&!t){if(this._config.chunk(i,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=i=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(i.data),this._completeResults.errors=this._completeResults.errors.concat(i.errors),this._completeResults.meta=i.meta),this._completed||!r||!_(this._config.complete)||i&&i.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),r||i&&i.meta.paused||this._nextChunk(),i}this._halted=!0},this._sendError=function(e){_(this._config.error)?this._config.error(e):o&&this._config.error&&n.postMessage({workerId:a.WORKER_ID,error:e,finished:!1})}}function l(e){var t;(e=e||{}).chunkSize||(e.chunkSize=a.RemoteChunkSize),c.call(this,e),this._nextChunk=r?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),r||(t.onload=w(this._chunkLoaded,this),t.onerror=w(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!r),this._config.downloadRequestHeaders){var e,n=this._config.downloadRequestHeaders;for(e in n)t.setRequestHeader(e,n[e])}var o;this._config.chunkSize&&(o=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+o));try{t.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}r&&0===t.status&&this._chunkError()}},this._chunkLoaded=function(){4===t.readyState&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(e=>null!==(e=e.getResponseHeader("Content-Range"))?parseInt(e.substring(e.lastIndexOf("/")+1)):-1)(t),this.parseChunk(t.responseText)))},this._chunkError=function(e){e=t.statusText||e,this._sendError(new Error(e))}}function u(e){(e=e||{}).chunkSize||(e.chunkSize=a.LocalChunkSize),c.call(this,e);var t,n,r="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,n=e.slice||e.webkitSlice||e.mozSlice,r?((t=new FileReader).onload=w(this._chunkLoaded,this),t.onerror=w(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input,o=(this._config.chunkSize&&(o=Math.min(this._start+this._config.chunkSize,this._input.size),e=n.call(e,this._start,o)),t.readAsText(e,this._config.encoding));r||this._chunkLoaded({target:{result:o}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function d(e){var t;c.call(this,e=e||{}),this.stream=function(e){return t=e,this._nextChunk()},this._nextChunk=function(){var e,n;if(!this._finished)return e=this._config.chunkSize,t=e?(n=t.substring(0,e),t.substring(e)):(n=t,""),this._finished=!t,this.parseChunk(n)}}function f(e){c.call(this,e=e||{});var t=[],n=!0,r=!1;this.pause=function(){c.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){c.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){r&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):n=!0},this._streamData=w(function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),n&&(n=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}},this),this._streamError=w(function(e){this._streamCleanUp(),this._sendError(e)},this),this._streamEnd=w(function(){this._streamCleanUp(),r=!0,this._streamData("")},this),this._streamCleanUp=w(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function h(e){var t,n,r,o,i=Math.pow(2,53),s=-i,c=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,l=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,u=this,d=0,f=0,h=!1,m=!1,y=[],v={data:[],errors:[],meta:{}};function w(t){return"greedy"===e.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}function E(){if(v&&r&&(k("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),r=!1),e.skipEmptyLines&&(v.data=v.data.filter(function(e){return!w(e)})),x()){if(v)if(Array.isArray(v.data[0])){for(var t=0;x()&&t<v.data.length;t++)v.data[t].forEach(n);v.data.splice(0,1)}else v.data.forEach(n);function n(t,n){_(e.transformHeader)&&(t=e.transformHeader(t,n)),y.push(t)}}function o(t,n){for(var r=e.header?{}:[],o=0;o<t.length;o++){var a=o,u=t[o];u=((t,n)=>(t=>(e.dynamicTypingFunction&&void 0===e.dynamicTyping[t]&&(e.dynamicTyping[t]=e.dynamicTypingFunction(t)),!0===(e.dynamicTyping[t]||e.dynamicTyping)))(t)?"true"===n||"TRUE"===n||"false"!==n&&"FALSE"!==n&&((e=>{if(c.test(e)&&(e=parseFloat(e),s<e&&e<i))return 1})(n)?parseFloat(n):l.test(n)?new Date(n):""===n?null:n):n)(a=e.header?o>=y.length?"__parsed_extra":y[o]:a,u=e.transform?e.transform(u,a):u),"__parsed_extra"===a?(r[a]=r[a]||[],r[a].push(u)):r[a]=u}return e.header&&(o>y.length?k("FieldMismatch","TooManyFields","Too many fields: expected "+y.length+" fields but parsed "+o,f+n):o<y.length&&k("FieldMismatch","TooFewFields","Too few fields: expected "+y.length+" fields but parsed "+o,f+n)),r}var u;v&&(e.header||e.dynamicTyping||e.transform)&&(u=1,!v.data.length||Array.isArray(v.data[0])?(v.data=v.data.map(o),u=v.data.length):v.data=o(v.data,0),e.header&&v.meta&&(v.meta.fields=y),f+=u)}function x(){return e.header&&0===y.length}function k(e,t,n,r){e={type:e,code:t,message:n},void 0!==r&&(e.row=r),v.errors.push(e)}_(e.step)&&(o=e.step,e.step=function(t){v=t,x()?E():(E(),0!==v.data.length&&(d+=t.data.length,e.preview&&d>e.preview?n.abort():(v.data=v.data[0],o(v,u))))}),this.parse=function(o,i,s){var c=e.quoteChar||'"';return e.newline||(e.newline=this.guessLineEndings(o,c)),r=!1,e.delimiter?_(e.delimiter)&&(e.delimiter=e.delimiter(o),v.meta.delimiter=e.delimiter):((c=((t,n,r,o,i)=>{var s,c,l,u;i=i||[",","\t","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var d=0;d<i.length;d++){for(var f,h=i[d],p=0,m=0,y=0,v=(l=void 0,new g({comments:o,delimiter:h,newline:n,preview:10}).parse(t)),b=0;b<v.data.length;b++)r&&w(v.data[b])?y++:(m+=f=v.data[b].length,void 0===l?l=f:0<f&&(p+=Math.abs(f-l),l=f));0<v.data.length&&(m/=v.data.length-y),(void 0===c||p<=c)&&(void 0===u||u<m)&&1.99<m&&(c=p,s=h,u=m)}return{successful:!!(e.delimiter=s),bestDelimiter:s}})(o,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess)).successful?e.delimiter=c.bestDelimiter:(r=!0,e.delimiter=a.DefaultDelimiter),v.meta.delimiter=e.delimiter),c=b(e),e.preview&&e.header&&c.preview++,t=o,n=new g(c),v=n.parse(t,i,s),E(),h?{meta:{paused:!0}}:v||{meta:{paused:!1}}},this.paused=function(){return h},this.pause=function(){h=!0,n.abort(),t=_(e.chunk)?"":t.substring(n.getCharIndex())},this.resume=function(){u.streamer._halted?(h=!1,u.streamer.parseChunk(t,!0)):setTimeout(u.resume,3)},this.aborted=function(){return m},this.abort=function(){m=!0,n.abort(),v.meta.aborted=!0,_(e.complete)&&e.complete(v),t=""},this.guessLineEndings=function(e,t){e=e.substring(0,1048576),t=new RegExp(p(t)+"([^]*?)"+p(t),"gm");var n=(e=e.replace(t,"")).split("\r");if(e=1<(t=e.split("\n")).length&&t[0].length<n[0].length,1===n.length||e)return"\n";for(var r=0,o=0;o<n.length;o++)"\n"===n[o][0]&&r++;return r>=n.length/2?"\r\n":"\r"}}function p(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function g(e){var t=(e=e||{}).delimiter,n=e.newline,r=e.comments,o=e.step,i=e.preview,s=e.fastMode,c=null,l=!1,u=null==e.quoteChar?'"':e.quoteChar,d=u;if(void 0!==e.escapeChar&&(d=e.escapeChar),("string"!=typeof t||-1<a.BAD_DELIMITERS.indexOf(t))&&(t=","),r===t)throw new Error("Comment character same as delimiter");!0===r?r="#":("string"!=typeof r||-1<a.BAD_DELIMITERS.indexOf(r))&&(r=!1),"\n"!==n&&"\r"!==n&&"\r\n"!==n&&(n="\n");var f=0,h=!1;this.parse=function(a,g,m){if("string"!=typeof a)throw new Error("Input must be a string");var y=a.length,v=t.length,b=n.length,w=r.length,E=_(o),x=[],k=[],S=[],R=f=0;if(!a)return P();if(s||!1!==s&&-1===a.indexOf(u)){for(var C=a.split(n),O=0;O<C.length;O++){if(S=C[O],f+=S.length,O!==C.length-1)f+=n.length;else if(m)return P();if(!r||S.substring(0,w)!==r){if(E){if(x=[],L(S.split(t)),U(),h)return P()}else L(S.split(t));if(i&&i<=O)return x=x.slice(0,i),P(!0)}}return P()}for(var T=a.indexOf(t,f),I=a.indexOf(n,f),A=new RegExp(p(d)+p(u),"g"),D=a.indexOf(u,f);;)if(a[f]===u)for(D=f,f++;;){if(-1===(D=a.indexOf(u,D+1)))return m||k.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:x.length,index:f}),F();if(D===y-1)return F(a.substring(f,D).replace(A,u));if(u===d&&a[D+1]===d)D++;else if(u===d||0===D||a[D-1]!==d){-1!==T&&T<D+1&&(T=a.indexOf(t,D+1));var $=M(-1===(I=-1!==I&&I<D+1?a.indexOf(n,D+1):I)?T:Math.min(T,I));if(a.substr(D+1+$,v)===t){S.push(a.substring(f,D).replace(A,u)),a[f=D+1+$+v]!==u&&(D=a.indexOf(u,f)),T=a.indexOf(t,f),I=a.indexOf(n,f);break}if($=M(I),a.substring(D+1+$,D+1+$+b)===n){if(S.push(a.substring(f,D).replace(A,u)),N(D+1+$+b),T=a.indexOf(t,f),D=a.indexOf(u,f),E&&(U(),h))return P();if(i&&x.length>=i)return P(!0);break}k.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:x.length,index:f}),D++}}else if(r&&0===S.length&&a.substring(f,f+w)===r){if(-1===I)return P();f=I+b,I=a.indexOf(n,f),T=a.indexOf(t,f)}else if(-1!==T&&(T<I||-1===I))S.push(a.substring(f,T)),f=T+v,T=a.indexOf(t,f);else{if(-1===I)break;if(S.push(a.substring(f,I)),N(I+b),E&&(U(),h))return P();if(i&&x.length>=i)return P(!0)}return F();function L(e){x.push(e),R=f}function M(e){return-1!==e&&(e=a.substring(D+1,e))&&""===e.trim()?e.length:0}function F(e){return m||(void 0===e&&(e=a.substring(f)),S.push(e),f=y,L(S),E&&U()),P()}function N(e){f=e,L(S),S=[],I=a.indexOf(n,f)}function P(r){if(e.header&&!g&&x.length&&!l){var o=x[0],i=Object.create(null),s=new Set(o);let t=!1;for(let n=0;n<o.length;n++){let r=o[n];if(i[r=_(e.transformHeader)?e.transformHeader(r,n):r]){let e,a=i[r];for(;e=r+"_"+a,a++,s.has(e););s.add(e),o[n]=e,i[r]++,t=!0,(c=null===c?{}:c)[e]=r}else i[r]=1,o[n]=r;s.add(r)}t&&console.warn("Duplicate headers found and renamed."),l=!0}return{data:x,errors:k,meta:{delimiter:t,linebreak:n,aborted:h,truncated:!!r,cursor:R+(g||0),renamedHeaders:c}}}function U(){o(P()),x=[],k=[]}},this.abort=function(){h=!0},this.getCharIndex=function(){return f}}function m(e){var t=e.data,n=i[t.workerId],r=!1;if(t.error)n.userError(t.error,t.file);else if(t.results&&t.results.data){var o={abort:function(){r=!0,y(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:v,resume:v};if(_(n.userStep)){for(var s=0;s<t.results.data.length&&(n.userStep({data:t.results.data[s],errors:t.results.errors,meta:t.results.meta},o),!r);s++);delete t.results}else _(n.userChunk)&&(n.userChunk(t.results,o,t.file),delete t.results)}t.finished&&!r&&y(t.workerId,t.results)}function y(e,t){var n=i[e];_(n.userComplete)&&n.userComplete(t),n.terminate(),delete i[e]}function v(){throw new Error("Not implemented.")}function b(e){if("object"!=typeof e||null===e)return e;var t,n=Array.isArray(e)?[]:{};for(t in e)n[t]=b(e[t]);return n}function w(e,t){return function(){e.apply(t,arguments)}}function _(e){return"function"==typeof e}return a.parse=function(t,r){var o=(r=r||{}).dynamicTyping||!1;if(_(o)&&(r.dynamicTypingFunction=o,o={}),r.dynamicTyping=o,r.transform=!!_(r.transform)&&r.transform,!r.worker||!a.WORKERS_SUPPORTED)return o=null,a.NODE_STREAM_INPUT,"string"==typeof t?(t=(e=>65279!==e.charCodeAt(0)?e:e.slice(1))(t),o=new(r.download?l:d)(r)):!0===t.readable&&_(t.read)&&_(t.on)?o=new f(r):(n.File&&t instanceof File||t instanceof Object)&&(o=new u(r)),o.stream(t);(o=(()=>{var t;return!!a.WORKERS_SUPPORTED&&(t=(()=>{var t=n.URL||n.webkitURL||null,r=e.toString();return a.BLOB_URL||(a.BLOB_URL=t.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",r,")();"],{type:"text/javascript"})))})(),(t=new n.Worker(t)).onmessage=m,t.id=s++,i[t.id]=t)})()).userStep=r.step,o.userChunk=r.chunk,o.userComplete=r.complete,o.userError=r.error,r.step=_(r.step),r.chunk=_(r.chunk),r.complete=_(r.complete),r.error=_(r.error),delete r.worker,o.postMessage({input:t,config:r,workerId:o.id})},a.unparse=function(e,t){var n=!1,r=!0,o=",",i="\r\n",s='"',c=s+s,l=!1,u=null,d=!1,f=((()=>{if("object"==typeof t){if("string"!=typeof t.delimiter||a.BAD_DELIMITERS.filter(function(e){return-1!==t.delimiter.indexOf(e)}).length||(o=t.delimiter),"boolean"!=typeof t.quotes&&"function"!=typeof t.quotes&&!Array.isArray(t.quotes)||(n=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(l=t.skipEmptyLines),"string"==typeof t.newline&&(i=t.newline),"string"==typeof t.quoteChar&&(s=t.quoteChar),"boolean"==typeof t.header&&(r=t.header),Array.isArray(t.columns)){if(0===t.columns.length)throw new Error("Option columns is empty");u=t.columns}void 0!==t.escapeChar&&(c=t.escapeChar+s),t.escapeFormulae instanceof RegExp?d=t.escapeFormulae:"boolean"==typeof t.escapeFormulae&&t.escapeFormulae&&(d=/^[=+\-@\t\r].*$/)}})(),new RegExp(p(s),"g"));if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return h(null,e,l);if("object"==typeof e[0])return h(u||Object.keys(e[0]),e,l)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||u),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:"object"==typeof e.data[0]?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),h(e.fields||[],e.data||[],l);throw new Error("Unable to serialize unrecognized input");function h(e,t,n){var s="",a=("string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t)),Array.isArray(e)&&0<e.length),c=!Array.isArray(t[0]);if(a&&r){for(var l=0;l<e.length;l++)0<l&&(s+=o),s+=g(e[l],l);0<t.length&&(s+=i)}for(var u=0;u<t.length;u++){var d=(a?e:t[u]).length,f=!1,h=a?0===Object.keys(t[u]).length:0===t[u].length;if(n&&!a&&(f="greedy"===n?""===t[u].join("").trim():1===t[u].length&&0===t[u][0].length),"greedy"===n&&a){for(var p=[],m=0;m<d;m++){var y=c?e[m]:m;p.push(t[u][y])}f=""===p.join("").trim()}if(!f){for(var v=0;v<d;v++){0<v&&!h&&(s+=o);var b=a&&c?e[v]:v;s+=g(t[u][b],v)}u<t.length-1&&(!n||0<d&&!h)&&(s+=i)}}return s}function g(e,t){var r,i;return null==e?"":e.constructor===Date?JSON.stringify(e).slice(1,25):(i=!1,d&&"string"==typeof e&&d.test(e)&&(e="'"+e,i=!0),r=e.toString().replace(f,c),(i=i||!0===n||"function"==typeof n&&n(e,t)||Array.isArray(n)&&n[t]||((e,t)=>{for(var n=0;n<t.length;n++)if(-1<e.indexOf(t[n]))return!0;return!1})(r,a.BAD_DELIMITERS)||-1<r.indexOf(o)||" "===r.charAt(0)||" "===r.charAt(r.length-1))?s+r+s:r)}},a.RECORD_SEP=String.fromCharCode(30),a.UNIT_SEP=String.fromCharCode(31),a.BYTE_ORDER_MARK="\ufeff",a.BAD_DELIMITERS=["\r","\n",'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!r&&!!n.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=g,a.ParserHandle=h,a.NetworkStreamer=l,a.FileStreamer=u,a.StringStreamer=d,a.ReadableStreamStreamer=f,n.jQuery&&((t=n.jQuery).fn.parse=function(e){var r=e.config||{},o=[];return this.each(function(e){if("INPUT"!==t(this).prop("tagName").toUpperCase()||"file"!==t(this).attr("type").toLowerCase()||!n.FileReader||!this.files||0===this.files.length)return!0;for(var i=0;i<this.files.length;i++)o.push({file:this.files[i],inputElem:this,instanceConfig:t.extend({},r)})}),i(),this;function i(){if(0===o.length)_(e.complete)&&e.complete();else{var n,r,i,c=o[0];if(_(e.before)){var l=e.before(c.file,c.inputElem);if("object"==typeof l){if("abort"===l.action)return n=c.file,r=c.inputElem,i=l.reason,void(_(e.error)&&e.error({name:"AbortError"},n,r,i));if("skip"===l.action)return void s();"object"==typeof l.config&&(c.instanceConfig=t.extend(c.instanceConfig,l.config))}else if("skip"===l)return void s()}var u=c.instanceConfig.complete;c.instanceConfig.complete=function(e){_(u)&&u(e,c.file,c.inputElem),s()},a.parse(c.file,c.instanceConfig)}}function s(){o.splice(0,1),i()}}),o&&(n.onmessage=function(e){e=e.data,void 0===a.WORKER_ID&&e&&(a.WORKER_ID=e.workerId),"string"==typeof e.input?n.postMessage({workerId:a.WORKER_ID,results:a.parse(e.input,e.config),finished:!0}):(n.File&&e.input instanceof File||e.input instanceof Object)&&(e=a.parse(e.input,e.config))&&n.postMessage({workerId:a.WORKER_ID,results:e,finished:!0})}),(l.prototype=Object.create(c.prototype)).constructor=l,(u.prototype=Object.create(c.prototype)).constructor=u,(d.prototype=Object.create(d.prototype)).constructor=d,(f.prototype=Object.create(c.prototype)).constructor=f,a},void 0===(r=n.apply(t,[]))||(e.exports=r)},58394:function(e,t,n){"use strict";e.exports=n.p+"1080d172e9fb74d9d46e.css"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}n.m=e,n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b="undefined"!=typeof document&&document.baseURI||self.location.href,function(){"use strict";var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};function t(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}function r(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function o(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s}function i(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}function s(e){return"function"==typeof e}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var a,c=((a=function(e){var t;t=this,Error.call(t),t.stack=(new Error).stack,this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map(function(e,t){return t+1+") "+e.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e}).prototype=Object.create(Error.prototype),a.prototype.constructor=a,a);function l(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var u=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var e,t,n,a,l;if(!this.closed){this.closed=!0;var u=this._parentage;if(u)if(this._parentage=null,Array.isArray(u))try{for(var d=r(u),h=d.next();!h.done;h=d.next())h.value.remove(this)}catch(t){e={error:t}}finally{try{h&&!h.done&&(t=d.return)&&t.call(d)}finally{if(e)throw e.error}}else u.remove(this);var p=this.initialTeardown;if(s(p))try{p()}catch(e){l=e instanceof c?e.errors:[e]}var g=this._finalizers;if(g){this._finalizers=null;try{for(var m=r(g),y=m.next();!y.done;y=m.next()){var v=y.value;try{f(v)}catch(e){l=null!=l?l:[],e instanceof c?l=i(i([],o(l)),o(e.errors)):l.push(e)}}}catch(e){n={error:e}}finally{try{y&&!y.done&&(a=m.return)&&a.call(m)}finally{if(n)throw n.error}}}if(l)throw new c(l)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)f(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&l(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&l(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}();function d(e){return e instanceof u||e&&"closed"in e&&s(e.remove)&&s(e.add)&&s(e.unsubscribe)}function f(e){s(e)?e():e.unsubscribe()}u.EMPTY;var h=null,p=null,g=void 0,m=!1,y=!1,v={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var s=v.delegate;return(null==s?void 0:s.setTimeout)?s.setTimeout.apply(s,i([e,t],o(n))):setTimeout.apply(void 0,i([e,t],o(n)))},clearTimeout:function(e){var t=v.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function b(){}var w=_("C",void 0,void 0);function _(e,t,n){return{kind:e,value:t,error:n}}var E=null,x=function(e){function n(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,d(t)&&t.add(n)):n.destination=I,n}return t(n,e),n.create=function(e,t,n){return new C(e,t,n)},n.prototype.next=function(e){this.isStopped?T(function(e){return _("N",e,void 0)}(e),this):this._next(e)},n.prototype.error=function(e){this.isStopped?T(_("E",void 0,e),this):(this.isStopped=!0,this._error(e))},n.prototype.complete=function(){this.isStopped?T(w,this):(this.isStopped=!0,this._complete())},n.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},n.prototype._next=function(e){this.destination.next(e)},n.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},n.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},n}(u),k=Function.prototype.bind;function S(e,t){return k.call(e,t)}var R=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){O(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){O(e)}else O(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){O(e)}},e}(),C=function(e){function n(t,n,r){var o,i,a=e.call(this)||this;return s(t)||!t?o={next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=r?r:void 0}:a&&y?((i=Object.create(t)).unsubscribe=function(){return a.unsubscribe()},o={next:t.next&&S(t.next,i),error:t.error&&S(t.error,i),complete:t.complete&&S(t.complete,i)}):o=t,a.destination=new R(o),a}return t(n,e),n}(x);function O(e){var t;m?(t=e,m&&E&&(E.errorThrown=!0,E.error=t)):function(e){v.setTimeout(function(){if(!h)throw e;h(e)})}(e)}function T(e,t){var n=p;n&&v.setTimeout(function(){return n(e,t)})}var I={closed:!0,next:b,error:function(e){throw e},complete:b};function A(e,t,n,r,o){return new D(e,t,n,r,o)}var D=function(e){function n(t,n,r,o,i,s){var a=e.call(this,t)||this;return a.onFinalize=i,a.shouldUnsubscribe=s,a._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,a._error=o?function(e){try{o(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,a._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,a}return t(n,e),n.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},n}(x);function $(e){return function(t){if(function(e){return s(null==e?void 0:e.lift)}(t))return t.lift(function(t){try{return e(t,this)}catch(e){this.error(e)}});throw new TypeError("Unable to lift unknown Observable type")}}function L(e,t){return $(function(e,t,n){return function(r,o){var i=n,s=t,a=0;r.subscribe(A(o,function(t){var n=a++;s=i?e(s,t,n):(i=!0,t)},function(){i&&o.next(s),o.complete()}))}}(e,t,arguments.length>=2))}var M=function(e,t){return e.push(t),e};function F(){return $(function(e,t){L(M,[])(e).subscribe(t)})}function N(e){return e}function P(e,t,n){var r=s(e)||t||n?{next:e,error:t,complete:n}:e;return r?$(function(e,t){var n;null===(n=r.subscribe)||void 0===n||n.call(r);var o=!0;e.subscribe(A(t,function(e){var n;null===(n=r.next)||void 0===n||n.call(r,e),t.next(e)},function(){var e;o=!1,null===(e=r.complete)||void 0===e||e.call(r),t.complete()},function(e){var n;o=!1,null===(n=r.error)||void 0===n||n.call(r,e),t.error(e)},function(){var e,t;o&&(null===(e=r.unsubscribe)||void 0===e||e.call(r)),null===(t=r.finalize)||void 0===t||t.call(r)}))}):N}var U="function"==typeof Symbol&&Symbol.observable||"@@observable";var j=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r,o=this,i=(r=e)&&r instanceof x||function(e){return e&&s(e.next)&&s(e.error)&&s(e.complete)}(r)&&d(r)?e:new C(e,t,n);return function(e){if(m){var t=!E;if(t&&(E={errorThrown:!1,error:null}),e(),t){var n=E,r=n.errorThrown,o=n.error;if(E=null,r)throw o}}else e()}(function(){var e=o,t=e.operator,n=e.source;i.add(t?t.call(i,n):n?o._subscribe(i):o._trySubscribe(i))}),i},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=B(t))(function(t,r){var o=new C({next:function(t){try{e(t)}catch(e){r(e),o.unsubscribe()}},error:r,complete:t});n.subscribe(o)})},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[U]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0===(n=e).length?N:1===n.length?n[0]:function(e){return n.reduce(function(e,t){return t(e)},e)})(this);var n},e.prototype.toPromise=function(e){var t=this;return new(e=B(e))(function(e,n){var r;t.subscribe(function(e){return r=e},function(e){return n(e)},function(){return e(r)})})},e.create=function(t){return new e(t)},e}();function B(e){var t;return null!==(t=null!=e?e:g)&&void 0!==t?t:Promise}function z(e){return new j(t=>{Excel.run(async n=>{const r=n.workbook.names.getItem(e).getRange().getUsedRange();r.load("values");try{await n.sync()}catch(t){throw console.error("Error getting range named '"+e+"':",t),t}r.values&&r.values.length>0&&r.values[0].length>0?r.values.flat().filter((e,t,n)=>""!==e&&n.indexOf(e)===t).forEach(e=>t.next(e)):t.next("Named range is empty or does not exist"),t.complete()}).catch(e=>t.error(e))})}function H(e){return new j(t=>{Excel.run(async n=>{const r=n.workbook.tables.getItem(e),o=r.getHeaderRowRange().load("values"),i=r.getDataBodyRange().load("values");try{await n.sync()}catch(t){throw console.error("Error getting rows for table '"+e+"':",t),t}const s=o.values[0];i.values.forEach(e=>{const n=s.reduce((t,n,r)=>(t[n]=e[r],t),{});t.next(n)}),t.complete()}).catch(e=>t.error(e))})}async function q(e,t){try{if(console.log(`WriteToTable called for '${e}' with ${t.length} rows.`),0===t.length)return void console.warn("No data to write to table '"+e+"'.");await Excel.run(async n=>{console.log(`WriteToTable: Getting table '${e}'...`);const r=n.workbook.tables.getItemOrNullObject(e);if(await n.sync(),r.isNullObject)throw new Error(`Table "${e}" not found.`);console.log(`WriteToTable: Adding rows to '${e}'...`),r.rows.add(null,t),await n.sync(),console.log(`WriteToTable: Successfully added rows to '${e}'.`)})}catch(n){throw console.error(`Error writing to table '${e}':`,n),console.error("Could not add data to table '"+e+"':",t),n}}async function W(){return new Promise((e,t)=>{z("Expenses").pipe(F(),P(t=>e(t))).subscribe({error(e){t(e)}})})}async function Y(){return new Promise((e,t)=>{H("Transactions").pipe(F(),P(t=>e(t))).subscribe({error:e=>t(e)})})}async function K(){return new Promise((e,t)=>{H("Rollovers").pipe(F()).subscribe({next:t=>e(t),error:e=>t(e)})})}async function Q(){return new Promise((e,t)=>{H("ExpenseData").pipe(F(),P(t=>e(t))).subscribe({error(e){t(e)}})})}async function G(){return new Promise((e,t)=>{H("BudgetHistory").pipe(F(),P(t=>e(t))).subscribe({error(e){t(e)}})})}var J=n(44809),V=n.n(J);class Z{static fromCsv(e){const t=V().parse(e,{header:!0}).data;return t.forEach(async e=>{e["Description 1"]?(e.id=await async function(e){const t=function(e){return(new TextEncoder).encode(`\n    ${e["Transaction Date"]}\n    ${e["Account Number"]}\n    ${e["Description 1"]}\n    ${e["Description 2"]}\n    ${e.CAD$}\n    ${e.USD$}\n  `)}(e),n=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map(e=>e.toString(16).padStart(2,"0")).join("")}(e),e["Transaction Date"]=new Date(e["Transaction Date"]),e.Month=e["Transaction Date"].getMonth()+1,e.Year=e["Transaction Date"].getFullYear(),e.Date=e["Transaction Date"].toLocaleDateString(),e.CAD$=e.CAD$?parseFloat(e.CAD$.toString()):null,e.USD$=e.USD$?parseFloat(e.USD$.toString()):null,e.Amount=e.USD$||e.CAD$||0,e.Description=e["Description 1"]+" "+e["Description 2"]):t.splice(t.indexOf(e),1)}),t}}async function X(e){var t=Z.fromCsv(e);console.log("Incoming Transactions:",t);const n=await W();console.log("Expenses:",n);const r=await async function(){return new Promise((e,t)=>{H("MatchingRules").pipe(F()).subscribe({next:t=>e(t),error:e=>t(e)})})}();console.log("Matching Rules:",r);const o=await async function(){return new Promise((e,t)=>{H("AmbiguousItems").pipe(F()).subscribe({next:t=>e(t),error:e=>t(e)})})}();console.log("Ambiguous Items:",o);const i=await async function(){return new Promise((e,t)=>{var n;H("Accounts").pipe((n=e=>{var t={};return t[e.Number]=e.Name,t},$(function(e,t){var r=0;e.subscribe(A(t,function(e){t.next(n.call(void 0,e,r++))}))})),L((e,t)=>({...e,...t}),{})).subscribe({next:t=>e(t),error:e=>t(e)})})}();console.log("accountNames:",i);const s=await async function(){return new Promise((e,t)=>{z("TransactionIds").pipe(F(),P(t=>e(t))).subscribe({error(e){t(e)}})})}(),a=[],c=new Map,l=new Array;return r.forEach(e=>{const t=`${e["Match 1"]}${e["Match 2"]}`;c.set(t,e["Expense Type"]),e["Match 2"]||l.push({match:e["Match 1"],expense:e["Expense Type"]})}),t.forEach(e=>{if(e.id&&s.includes(e.id))return;if(a.push(e),e["Account Name"]=i[e["Account Number"]],e.Account=`${e["Account Name"]} (${e["Account Number"].slice(-4)})`,o.some(t=>e["Description 1"].toLowerCase().includes(t.Item.toLowerCase())))return console.warn("Transaction flagged as ambiguous:",e["Description 1"]),void(e.Expense="Ambiguous");let t=c.get(`${e["Description 1"]}${e["Description 2"]}`);if(t)e.Expense=t;else{for(let t of l)if(e["Description 1"].toLowerCase().includes(t.match.toLowerCase()))return void(e.Expense=t.expense);console.warn("No match found for transaction:",e["Description 1"],e["Description 2"])}}),console.log("New Transactions:",a),a.map(e=>[e.id,e.Month,e.Year,e.Date,e.Account,e.Expense,e.Amount,e.Description,e.Memo])}function ee(e,t){const n=document.getElementById("error-container"),r=document.getElementById("error-content"),o=document.getElementById("error-details");if(!n||!r||!o)return console.error("Error UI elements not found. Logging to console only."),void console.error(`[${t}]`,e);const i=`--- ERROR REPORT ---\nContext: ${t}\nTime: ${(new Date).toISOString()}\nMessage: ${e instanceof Error?e.message:String(e)}\n\nStack Trace:\n${e instanceof Error?e.stack:"No stack trace available"}\n--------------------`;o.textContent=i,n.style.display="block",console.error(`[${t}]`,e)}function te(){const e=document.getElementById("error-details");if(!e)return;const t=e.textContent||"";navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(t).then(re).catch(e=>{console.warn("Clipboard API failed, trying fallback",e),ne(t)}):ne(t)}function ne(e){const t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.opacity="0",t.style.zIndex="-1",document.body.appendChild(t),t.focus(),t.select();try{document.execCommand("copy")?(console.log("Fallback copy successful"),re()):console.error("Fallback copy failed (execCommand returned false).")}catch(e){console.error("Fallback copy failed with error:",e)}document.body.removeChild(t)}function re(){const e=document.getElementById("error-copy-btn");if(e){const t=e.textContent;e.textContent="Copied!",setTimeout(()=>e.textContent=t,2e3)}}function oe(){const e=document.getElementById("error-container");e&&(e.style.display="none")}function ie(e,t="info"){const n=document.getElementById("console-output");if(n){const r=document.createElement("div");r.className=`log-entry ${t}`,r.textContent=`> ${e}`,n.appendChild(r),n.scrollTop=n.scrollHeight}}function se(){const e=document.getElementById("console-output");e&&(e.innerHTML="",ie("Console cleared."))}function ae(e){e.preventDefault(),e.stopPropagation()}function ce(e){var t=e.dataTransfer.files;if(t.length>0){var n=t[0];ie(`Reading file: ${n.name}...`,"info");var r=new FileReader;r.onload=le,r.readAsText(n)}}async function le(e){try{var t=e.target.result;ie("Processing transactions...","info");const n=await X(t);await q("Transactions",n),ie(`Successfully imported ${n.length} transactions.`,"success")}catch(e){ee(e,"ProcessFileDrop"),ie("Failed to process file.","error")}}async function ue(e,t,n=null){let r;r=n?[n]:await W();let o=new Date,i=o.getMonth()+1,s=o.getFullYear();const[a,c,l,u]=await Promise.all([K(),Y(),Q(),G()]),d=new Map;a.forEach((e,t)=>{const n=`${e.Month}-${e.Year}-${e.Expense}`;d.set(n,{entry:e,index:t})});const f=new Map;c.forEach(e=>{const t=`${e.Month}-${e.Year}-${e["Expense Type"]}`,n=f.get(t)||0;f.set(t,n+(e.Amount||0))});const h=new Map;l.forEach(e=>{h.set(e["Expense Type"],{Budget:parseFloat(e.Budget||0),Init:parseFloat(e.Init||0)})});const p=[],g=[],m=(e,t,n)=>{const r=u.find(r=>r.Expense===e&&r["Month Start"]<=t&&t<=r["Month End"]&&r["Year Start"]<=n&&n<=r["Year End"]);return r?parseFloat(r.Amount):h.get(e)?.Budget||0},y=e=>h.get(e)?.Init||0;for(const n of r){let r=24,o=e,a=t;if(a>s||a===s&&o>i)return void console.error("Cannot reset rollover for a future date.");for(;(a<s||a===s&&o<=i)&&r>0;){const e=`${o}-${a}-${n}`;let t=d.get(e),i=t?{...t.entry}:null;const s=m(n,o,a);let c=o-1,l=a;0===c&&(c=12,l--);const u=`${c}-${l}-${n}`,h=d.get(u);let v=0;v=h?h.entry.EOM:y(n);const b=f.get(`${o}-${a}-${n}`)||0;i||(i={Month:o,Year:a,Expense:n,Expenses:0,BOM:0,EOM:0}),i.Expenses=b,i.BOM=v,i.EOM=i.BOM+s+b,t?(t.entry=i,p.push({rowIndex:t.index,data:i})):(g.push(i),d.set(e,{entry:i,index:-1})),o++,13===o&&(o=1,a++),r--}}if(p.length>0&&await async function(e,t){0!==t.length&&(console.log(`UpdateTableRows called for '${e}' with ${t.length} updates.`),await Excel.run(async n=>{console.log(`UpdateTableRows: Getting table '${e}'...`);const r=n.workbook.tables.getItem(e),o=r.getHeaderRowRange().load("values");await n.sync();const i=o.values[0];console.log(`UpdateTableRows: Processing updates for '${e}'...`),t.forEach(e=>{const t=r.getDataBodyRange().getRow(e.rowIndex),n=i.map(t=>e.data[t]??null);t.values=[n]}),console.log(`UpdateTableRows: Syncing updates for '${e}'...`),await n.sync(),console.log(`UpdateTableRows: Successfully updated rows in '${e}'.`)}).catch(t=>{throw console.error(`Error updating rows in table '${e}':`,t),t}))}("Rollovers",p),g.length>0){const e=g.map(e=>[e.Month,e.Year,e.Expense,e.Expenses,e.BOM,e.EOM]);await q("Rollovers",e)}await async function(e){const t=e.toISOString().split("T")[0];try{console.log(`Attempting to set Named Range 'LastRolloverUpdate' to ${t}...`),await async function(e,t){console.log(`SetNamedRangeValue called for '${e}' with value '${t}'.`),await Excel.run(async n=>{try{console.log(`SetNamedRangeValue: Getting named item '${e}'...`);let r=n.workbook.names.getItemOrNullObject(e);await n.sync(),r.isNullObject&&(console.warn(`Named range '${e}' not found. Attempting to create it at Rollovers!H1.`),r=n.workbook.names.add(e,"Rollovers!H1")),console.log(`SetNamedRangeValue: Setting value for '${e}'...`),r.getRange().values=[[t]],await n.sync(),console.log(`SetNamedRangeValue: Successfully set value for '${e}'.`)}catch(t){console.warn(`Warning: Could not set named range '${e}'. This is non-critical. Error:`,t)}}).catch(t=>{console.warn(`Excel.run failed in SetNamedRangeValue for '${e}':`,t)})}("LastRolloverUpdate",t),console.log("Successfully set Named Range.")}catch(e){console.warn("Failed to set Named Range for Last Update (non-critical):",e)}try{console.log("Setting Document Settings 'LastRolloverUpdate'..."),Office.context.document.settings.set("LastRolloverUpdate",t),console.log("Calling saveAsync on Document Settings..."),await new Promise(e=>{Office.context.document.settings.saveAsync(t=>{console.log("saveAsync callback received. Status:",t.status),t.status===Office.AsyncResultStatus.Failed?console.error("Failed to save to Document Settings:",t.error):console.log("Saved Last Update to Document Settings."),e()})})}catch(e){console.error("Critical error in settings fallback:",e)}}(new Date)}async function de(){try{const e=await async function(){return new Promise((e,t)=>{z("LastRolloverUpdate").pipe(F(),P(t=>{if(t.length>0&&t[0])e(new Date(t[0]));else{const t=Office.context.document.settings.get("LastRolloverUpdate");e(t?new Date(t):null)}})).subscribe({error(t){console.warn("Could not fetch LastRolloverUpdate from Named Range, trying Settings:",t);const n=Office.context.document.settings.get("LastRolloverUpdate");e(n?new Date(n):null)}})})}(),t=document.getElementById("last-updated");e?(t.textContent=`Synced: ${e.toISOString().split("T")[0]}`,document.getElementById("month-input").value=(e.getMonth()+1).toString(),document.getElementById("year-input").value=e.getFullYear().toString(),ie(`Last sync found: ${e.toLocaleDateString()}`,"info")):(t.textContent="Synced: Never",ie("No previous sync date found.","warn"))}catch(e){console.error("Error fetching last update:",e)}}async function fe(){try{ie("Starting rollover recalculation...","info");var e=parseInt(document.getElementById("month-input").value),t=parseInt(document.getElementById("year-input").value);let n=document.getElementById("expense-dropdown"),r=n.options[n.selectedIndex].text;"All Expenses"===r&&(r=null),await Excel.run(async n=>{await ue(e,t,r),await n.sync()}),ie("Recalculation complete.","success"),await de()}catch(e){ee(e,"TriggerResetRollovers"),ie("Error during recalculation.","error")}}Office.onReady(e=>{if(e.host===Office.HostType.Excel){document.getElementById("error-close-btn").addEventListener("click",oe),document.getElementById("error-copy-btn").addEventListener("click",te),document.getElementById("clear-console").addEventListener("click",se);const e=new Date;document.getElementById("month-input").value=(e.getMonth()+1).toString(),document.getElementById("year-input").value=e.getFullYear().toString();let t=document.getElementById("drop-area");["dragenter","dragover","dragleave","drop"].forEach(e=>{t.addEventListener(e,ae,!1)}),["dragenter","dragover"].forEach(e=>{t.addEventListener(e,e=>{t.classList.add("highlight")},!1)}),["dragleave","drop"].forEach(e=>{t.addEventListener(e,e=>{t.classList.remove("highlight")},!1)}),t.addEventListener("drop",ce,!1),document.getElementById("reset").onclick=fe,window.onload=async()=>{ie("Initializing..."),await async function(){try{await async function(e,t,n=e){await Excel.run(async r=>{const o=r.workbook.tables.getItemOrNullObject(e);if(await r.sync(),!o.isNullObject)return;console.log(`Table '${e}' not found. Creating it...`);let i=r.workbook.worksheets.getItemOrNullObject(n);await r.sync(),i.isNullObject&&(console.log(`Sheet '${n}' not found. Creating it...`),i=r.workbook.worksheets.add(n));const s=`A1:${String.fromCharCode("A".charCodeAt(0)+t.length-1)}1`,a=i.tables.add(s,!0);a.name=e,a.getHeaderRowRange().values=[t],await r.sync(),console.log(`Table '${e}' created successfully.`)}).catch(t=>{throw console.error(`Error ensuring table '${e}' exists:`,t),t})}("AmbiguousItems",["Item","IsAmbiguous","OverrideCount","Confidence"])}catch(e){console.error("Schema initialization failed:",e)}}(),await async function(){try{const e=await W(),t=document.getElementById("expense-dropdown");t.innerHTML='<option value="">All Expenses</option>';for(const n of e){const e=document.createElement("option");e.value=e.text=n,t.add(e)}ie(`Loaded ${e.length} expense categories.`,"info")}catch(e){ee(e,"populateExpenseDropdown")}}(),await de(),ie("Ready.")}}})}(),function(){"use strict";var e=n(14385),t=n.n(e),r=new URL(n(58394),n.b);t()(r)}()}();
//# sourceMappingURL=taskpane.js.map