/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var e={14385:function(e){"use strict";e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),t.hash&&(e+=t.hash),t.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(e)?'"'.concat(e,'"'):e):e}},44809:function(e,t){var n,r;n=function e(){var t,n="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n?n:{},r=!n.document&&!!n.postMessage,i=n.IS_PAPA_WORKER||!1,o={},s=0,a={};function c(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=b(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new h(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,t){var r=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<r){let t=this._config.newline;t||(o=this._config.quoteChar||'"',t=this._handle.guessLineEndings(e,o)),e=[...e.split(t).slice(r)].join(t)}this.isFirstChunk&&w(this._config.beforeFirstChunk)&&void 0!==(o=this._config.beforeFirstChunk(e))&&(e=o),this.isFirstChunk=!1,this._halted=!1,r=this._partialLine+e;var o=(this._partialLine="",this._handle.parse(r,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(e=o.meta.cursor,this._finished||(this._partialLine=r.substring(e-this._baseIndex),this._baseIndex=e),o&&o.data&&(this._rowCount+=o.data.length),r=this._finished||this._config.preview&&this._rowCount>=this._config.preview,i)n.postMessage({results:o,workerId:a.WORKER_ID,finished:r});else if(w(this._config.chunk)&&!t){if(this._config.chunk(o,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=o=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(o.data),this._completeResults.errors=this._completeResults.errors.concat(o.errors),this._completeResults.meta=o.meta),this._completed||!r||!w(this._config.complete)||o&&o.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),r||o&&o.meta.paused||this._nextChunk(),o}this._halted=!0},this._sendError=function(e){w(this._config.error)?this._config.error(e):i&&this._config.error&&n.postMessage({workerId:a.WORKER_ID,error:e,finished:!1})}}function u(e){var t;(e=e||{}).chunkSize||(e.chunkSize=a.RemoteChunkSize),c.call(this,e),this._nextChunk=r?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),r||(t.onload=_(this._chunkLoaded,this),t.onerror=_(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!r),this._config.downloadRequestHeaders){var e,n=this._config.downloadRequestHeaders;for(e in n)t.setRequestHeader(e,n[e])}var i;this._config.chunkSize&&(i=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+i));try{t.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}r&&0===t.status&&this._chunkError()}},this._chunkLoaded=function(){4===t.readyState&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(e=>null!==(e=e.getResponseHeader("Content-Range"))?parseInt(e.substring(e.lastIndexOf("/")+1)):-1)(t),this.parseChunk(t.responseText)))},this._chunkError=function(e){e=t.statusText||e,this._sendError(new Error(e))}}function l(e){(e=e||{}).chunkSize||(e.chunkSize=a.LocalChunkSize),c.call(this,e);var t,n,r="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,n=e.slice||e.webkitSlice||e.mozSlice,r?((t=new FileReader).onload=_(this._chunkLoaded,this),t.onerror=_(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input,i=(this._config.chunkSize&&(i=Math.min(this._start+this._config.chunkSize,this._input.size),e=n.call(e,this._start,i)),t.readAsText(e,this._config.encoding));r||this._chunkLoaded({target:{result:i}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function f(e){var t;c.call(this,e=e||{}),this.stream=function(e){return t=e,this._nextChunk()},this._nextChunk=function(){var e,n;if(!this._finished)return e=this._config.chunkSize,t=e?(n=t.substring(0,e),t.substring(e)):(n=t,""),this._finished=!t,this.parseChunk(n)}}function d(e){c.call(this,e=e||{});var t=[],n=!0,r=!1;this.pause=function(){c.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){c.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){r&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):n=!0},this._streamData=_(function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),n&&(n=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}},this),this._streamError=_(function(e){this._streamCleanUp(),this._sendError(e)},this),this._streamEnd=_(function(){this._streamCleanUp(),r=!0,this._streamData("")},this),this._streamCleanUp=_(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function h(e){var t,n,r,i,o=Math.pow(2,53),s=-o,c=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,u=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,l=this,f=0,d=0,h=!1,m=!1,y=[],v={data:[],errors:[],meta:{}};function _(t){return"greedy"===e.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}function E(){if(v&&r&&(k("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),r=!1),e.skipEmptyLines&&(v.data=v.data.filter(function(e){return!_(e)})),x()){if(v)if(Array.isArray(v.data[0])){for(var t=0;x()&&t<v.data.length;t++)v.data[t].forEach(n);v.data.splice(0,1)}else v.data.forEach(n);function n(t,n){w(e.transformHeader)&&(t=e.transformHeader(t,n)),y.push(t)}}function i(t,n){for(var r=e.header?{}:[],i=0;i<t.length;i++){var a=i,l=t[i];l=((t,n)=>(t=>(e.dynamicTypingFunction&&void 0===e.dynamicTyping[t]&&(e.dynamicTyping[t]=e.dynamicTypingFunction(t)),!0===(e.dynamicTyping[t]||e.dynamicTyping)))(t)?"true"===n||"TRUE"===n||"false"!==n&&"FALSE"!==n&&((e=>{if(c.test(e)&&(e=parseFloat(e),s<e&&e<o))return 1})(n)?parseFloat(n):u.test(n)?new Date(n):""===n?null:n):n)(a=e.header?i>=y.length?"__parsed_extra":y[i]:a,l=e.transform?e.transform(l,a):l),"__parsed_extra"===a?(r[a]=r[a]||[],r[a].push(l)):r[a]=l}return e.header&&(i>y.length?k("FieldMismatch","TooManyFields","Too many fields: expected "+y.length+" fields but parsed "+i,d+n):i<y.length&&k("FieldMismatch","TooFewFields","Too few fields: expected "+y.length+" fields but parsed "+i,d+n)),r}var l;v&&(e.header||e.dynamicTyping||e.transform)&&(l=1,!v.data.length||Array.isArray(v.data[0])?(v.data=v.data.map(i),l=v.data.length):v.data=i(v.data,0),e.header&&v.meta&&(v.meta.fields=y),d+=l)}function x(){return e.header&&0===y.length}function k(e,t,n,r){e={type:e,code:t,message:n},void 0!==r&&(e.row=r),v.errors.push(e)}w(e.step)&&(i=e.step,e.step=function(t){v=t,x()?E():(E(),0!==v.data.length&&(f+=t.data.length,e.preview&&f>e.preview?n.abort():(v.data=v.data[0],i(v,l))))}),this.parse=function(i,o,s){var c=e.quoteChar||'"';return e.newline||(e.newline=this.guessLineEndings(i,c)),r=!1,e.delimiter?w(e.delimiter)&&(e.delimiter=e.delimiter(i),v.meta.delimiter=e.delimiter):((c=((t,n,r,i,o)=>{var s,c,u,l;o=o||[",","\t","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var f=0;f<o.length;f++){for(var d,h=o[f],p=0,m=0,y=0,v=(u=void 0,new g({comments:i,delimiter:h,newline:n,preview:10}).parse(t)),b=0;b<v.data.length;b++)r&&_(v.data[b])?y++:(m+=d=v.data[b].length,void 0===u?u=d:0<d&&(p+=Math.abs(d-u),u=d));0<v.data.length&&(m/=v.data.length-y),(void 0===c||p<=c)&&(void 0===l||l<m)&&1.99<m&&(c=p,s=h,l=m)}return{successful:!!(e.delimiter=s),bestDelimiter:s}})(i,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess)).successful?e.delimiter=c.bestDelimiter:(r=!0,e.delimiter=a.DefaultDelimiter),v.meta.delimiter=e.delimiter),c=b(e),e.preview&&e.header&&c.preview++,t=i,n=new g(c),v=n.parse(t,o,s),E(),h?{meta:{paused:!0}}:v||{meta:{paused:!1}}},this.paused=function(){return h},this.pause=function(){h=!0,n.abort(),t=w(e.chunk)?"":t.substring(n.getCharIndex())},this.resume=function(){l.streamer._halted?(h=!1,l.streamer.parseChunk(t,!0)):setTimeout(l.resume,3)},this.aborted=function(){return m},this.abort=function(){m=!0,n.abort(),v.meta.aborted=!0,w(e.complete)&&e.complete(v),t=""},this.guessLineEndings=function(e,t){e=e.substring(0,1048576),t=new RegExp(p(t)+"([^]*?)"+p(t),"gm");var n=(e=e.replace(t,"")).split("\r");if(e=1<(t=e.split("\n")).length&&t[0].length<n[0].length,1===n.length||e)return"\n";for(var r=0,i=0;i<n.length;i++)"\n"===n[i][0]&&r++;return r>=n.length/2?"\r\n":"\r"}}function p(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function g(e){var t=(e=e||{}).delimiter,n=e.newline,r=e.comments,i=e.step,o=e.preview,s=e.fastMode,c=null,u=!1,l=null==e.quoteChar?'"':e.quoteChar,f=l;if(void 0!==e.escapeChar&&(f=e.escapeChar),("string"!=typeof t||-1<a.BAD_DELIMITERS.indexOf(t))&&(t=","),r===t)throw new Error("Comment character same as delimiter");!0===r?r="#":("string"!=typeof r||-1<a.BAD_DELIMITERS.indexOf(r))&&(r=!1),"\n"!==n&&"\r"!==n&&"\r\n"!==n&&(n="\n");var d=0,h=!1;this.parse=function(a,g,m){if("string"!=typeof a)throw new Error("Input must be a string");var y=a.length,v=t.length,b=n.length,_=r.length,E=w(i),x=[],k=[],S=[],C=d=0;if(!a)return j();if(s||!1!==s&&-1===a.indexOf(l)){for(var R=a.split(n),O=0;O<R.length;O++){if(S=R[O],d+=S.length,O!==R.length-1)d+=n.length;else if(m)return j();if(!r||S.substring(0,_)!==r){if(E){if(x=[],L(S.split(t)),B(),h)return j()}else L(S.split(t));if(o&&o<=O)return x=x.slice(0,o),j(!0)}}return j()}for(var T=a.indexOf(t,d),I=a.indexOf(n,d),A=new RegExp(p(f)+p(l),"g"),D=a.indexOf(l,d);;)if(a[d]===l)for(D=d,d++;;){if(-1===(D=a.indexOf(l,D+1)))return m||k.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:x.length,index:d}),F();if(D===y-1)return F(a.substring(d,D).replace(A,l));if(l===f&&a[D+1]===f)D++;else if(l===f||0===D||a[D-1]!==f){-1!==T&&T<D+1&&(T=a.indexOf(t,D+1));var $=M(-1===(I=-1!==I&&I<D+1?a.indexOf(n,D+1):I)?T:Math.min(T,I));if(a.substr(D+1+$,v)===t){S.push(a.substring(d,D).replace(A,l)),a[d=D+1+$+v]!==l&&(D=a.indexOf(l,d)),T=a.indexOf(t,d),I=a.indexOf(n,d);break}if($=M(I),a.substring(D+1+$,D+1+$+b)===n){if(S.push(a.substring(d,D).replace(A,l)),P(D+1+$+b),T=a.indexOf(t,d),D=a.indexOf(l,d),E&&(B(),h))return j();if(o&&x.length>=o)return j(!0);break}k.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:x.length,index:d}),D++}}else if(r&&0===S.length&&a.substring(d,d+_)===r){if(-1===I)return j();d=I+b,I=a.indexOf(n,d),T=a.indexOf(t,d)}else if(-1!==T&&(T<I||-1===I))S.push(a.substring(d,T)),d=T+v,T=a.indexOf(t,d);else{if(-1===I)break;if(S.push(a.substring(d,I)),P(I+b),E&&(B(),h))return j();if(o&&x.length>=o)return j(!0)}return F();function L(e){x.push(e),C=d}function M(e){return-1!==e&&(e=a.substring(D+1,e))&&""===e.trim()?e.length:0}function F(e){return m||(void 0===e&&(e=a.substring(d)),S.push(e),d=y,L(S),E&&B()),j()}function P(e){d=e,L(S),S=[],I=a.indexOf(n,d)}function j(r){if(e.header&&!g&&x.length&&!u){var i=x[0],o=Object.create(null),s=new Set(i);let t=!1;for(let n=0;n<i.length;n++){let r=i[n];if(o[r=w(e.transformHeader)?e.transformHeader(r,n):r]){let e,a=o[r];for(;e=r+"_"+a,a++,s.has(e););s.add(e),i[n]=e,o[r]++,t=!0,(c=null===c?{}:c)[e]=r}else o[r]=1,i[n]=r;s.add(r)}t&&console.warn("Duplicate headers found and renamed."),u=!0}return{data:x,errors:k,meta:{delimiter:t,linebreak:n,aborted:h,truncated:!!r,cursor:C+(g||0),renamedHeaders:c}}}function B(){i(j()),x=[],k=[]}},this.abort=function(){h=!0},this.getCharIndex=function(){return d}}function m(e){var t=e.data,n=o[t.workerId],r=!1;if(t.error)n.userError(t.error,t.file);else if(t.results&&t.results.data){var i={abort:function(){r=!0,y(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:v,resume:v};if(w(n.userStep)){for(var s=0;s<t.results.data.length&&(n.userStep({data:t.results.data[s],errors:t.results.errors,meta:t.results.meta},i),!r);s++);delete t.results}else w(n.userChunk)&&(n.userChunk(t.results,i,t.file),delete t.results)}t.finished&&!r&&y(t.workerId,t.results)}function y(e,t){var n=o[e];w(n.userComplete)&&n.userComplete(t),n.terminate(),delete o[e]}function v(){throw new Error("Not implemented.")}function b(e){if("object"!=typeof e||null===e)return e;var t,n=Array.isArray(e)?[]:{};for(t in e)n[t]=b(e[t]);return n}function _(e,t){return function(){e.apply(t,arguments)}}function w(e){return"function"==typeof e}return a.parse=function(t,r){var i=(r=r||{}).dynamicTyping||!1;if(w(i)&&(r.dynamicTypingFunction=i,i={}),r.dynamicTyping=i,r.transform=!!w(r.transform)&&r.transform,!r.worker||!a.WORKERS_SUPPORTED)return i=null,a.NODE_STREAM_INPUT,"string"==typeof t?(t=(e=>65279!==e.charCodeAt(0)?e:e.slice(1))(t),i=new(r.download?u:f)(r)):!0===t.readable&&w(t.read)&&w(t.on)?i=new d(r):(n.File&&t instanceof File||t instanceof Object)&&(i=new l(r)),i.stream(t);(i=(()=>{var t;return!!a.WORKERS_SUPPORTED&&(t=(()=>{var t=n.URL||n.webkitURL||null,r=e.toString();return a.BLOB_URL||(a.BLOB_URL=t.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",r,")();"],{type:"text/javascript"})))})(),(t=new n.Worker(t)).onmessage=m,t.id=s++,o[t.id]=t)})()).userStep=r.step,i.userChunk=r.chunk,i.userComplete=r.complete,i.userError=r.error,r.step=w(r.step),r.chunk=w(r.chunk),r.complete=w(r.complete),r.error=w(r.error),delete r.worker,i.postMessage({input:t,config:r,workerId:i.id})},a.unparse=function(e,t){var n=!1,r=!0,i=",",o="\r\n",s='"',c=s+s,u=!1,l=null,f=!1,d=((()=>{if("object"==typeof t){if("string"!=typeof t.delimiter||a.BAD_DELIMITERS.filter(function(e){return-1!==t.delimiter.indexOf(e)}).length||(i=t.delimiter),"boolean"!=typeof t.quotes&&"function"!=typeof t.quotes&&!Array.isArray(t.quotes)||(n=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(u=t.skipEmptyLines),"string"==typeof t.newline&&(o=t.newline),"string"==typeof t.quoteChar&&(s=t.quoteChar),"boolean"==typeof t.header&&(r=t.header),Array.isArray(t.columns)){if(0===t.columns.length)throw new Error("Option columns is empty");l=t.columns}void 0!==t.escapeChar&&(c=t.escapeChar+s),t.escapeFormulae instanceof RegExp?f=t.escapeFormulae:"boolean"==typeof t.escapeFormulae&&t.escapeFormulae&&(f=/^[=+\-@\t\r].*$/)}})(),new RegExp(p(s),"g"));if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return h(null,e,u);if("object"==typeof e[0])return h(l||Object.keys(e[0]),e,u)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||l),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:"object"==typeof e.data[0]?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),h(e.fields||[],e.data||[],u);throw new Error("Unable to serialize unrecognized input");function h(e,t,n){var s="",a=("string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t)),Array.isArray(e)&&0<e.length),c=!Array.isArray(t[0]);if(a&&r){for(var u=0;u<e.length;u++)0<u&&(s+=i),s+=g(e[u],u);0<t.length&&(s+=o)}for(var l=0;l<t.length;l++){var f=(a?e:t[l]).length,d=!1,h=a?0===Object.keys(t[l]).length:0===t[l].length;if(n&&!a&&(d="greedy"===n?""===t[l].join("").trim():1===t[l].length&&0===t[l][0].length),"greedy"===n&&a){for(var p=[],m=0;m<f;m++){var y=c?e[m]:m;p.push(t[l][y])}d=""===p.join("").trim()}if(!d){for(var v=0;v<f;v++){0<v&&!h&&(s+=i);var b=a&&c?e[v]:v;s+=g(t[l][b],v)}l<t.length-1&&(!n||0<f&&!h)&&(s+=o)}}return s}function g(e,t){var r,o;return null==e?"":e.constructor===Date?JSON.stringify(e).slice(1,25):(o=!1,f&&"string"==typeof e&&f.test(e)&&(e="'"+e,o=!0),r=e.toString().replace(d,c),(o=o||!0===n||"function"==typeof n&&n(e,t)||Array.isArray(n)&&n[t]||((e,t)=>{for(var n=0;n<t.length;n++)if(-1<e.indexOf(t[n]))return!0;return!1})(r,a.BAD_DELIMITERS)||-1<r.indexOf(i)||" "===r.charAt(0)||" "===r.charAt(r.length-1))?s+r+s:r)}},a.RECORD_SEP=String.fromCharCode(30),a.UNIT_SEP=String.fromCharCode(31),a.BYTE_ORDER_MARK="\ufeff",a.BAD_DELIMITERS=["\r","\n",'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!r&&!!n.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=g,a.ParserHandle=h,a.NetworkStreamer=u,a.FileStreamer=l,a.StringStreamer=f,a.ReadableStreamStreamer=d,n.jQuery&&((t=n.jQuery).fn.parse=function(e){var r=e.config||{},i=[];return this.each(function(e){if("INPUT"!==t(this).prop("tagName").toUpperCase()||"file"!==t(this).attr("type").toLowerCase()||!n.FileReader||!this.files||0===this.files.length)return!0;for(var o=0;o<this.files.length;o++)i.push({file:this.files[o],inputElem:this,instanceConfig:t.extend({},r)})}),o(),this;function o(){if(0===i.length)w(e.complete)&&e.complete();else{var n,r,o,c=i[0];if(w(e.before)){var u=e.before(c.file,c.inputElem);if("object"==typeof u){if("abort"===u.action)return n=c.file,r=c.inputElem,o=u.reason,void(w(e.error)&&e.error({name:"AbortError"},n,r,o));if("skip"===u.action)return void s();"object"==typeof u.config&&(c.instanceConfig=t.extend(c.instanceConfig,u.config))}else if("skip"===u)return void s()}var l=c.instanceConfig.complete;c.instanceConfig.complete=function(e){w(l)&&l(e,c.file,c.inputElem),s()},a.parse(c.file,c.instanceConfig)}}function s(){i.splice(0,1),o()}}),i&&(n.onmessage=function(e){e=e.data,void 0===a.WORKER_ID&&e&&(a.WORKER_ID=e.workerId),"string"==typeof e.input?n.postMessage({workerId:a.WORKER_ID,results:a.parse(e.input,e.config),finished:!0}):(n.File&&e.input instanceof File||e.input instanceof Object)&&(e=a.parse(e.input,e.config))&&n.postMessage({workerId:a.WORKER_ID,results:e,finished:!0})}),(u.prototype=Object.create(c.prototype)).constructor=u,(l.prototype=Object.create(c.prototype)).constructor=l,(f.prototype=Object.create(f.prototype)).constructor=f,(d.prototype=Object.create(c.prototype)).constructor=d,a},void 0===(r=n.apply(t,[]))||(e.exports=r)},58394:function(e,t,n){"use strict";e.exports=n.p+"1080d172e9fb74d9d46e.css"}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.m=e,n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var i=r.length-1;i>-1&&(!e||!/^http(s?):/.test(e));)e=r[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b="undefined"!=typeof document&&document.baseURI||self.location.href,function(){"use strict";var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};function t(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}function r(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function i(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function o(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function s(e){return"function"==typeof e}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var a,c=((a=function(e){var t;t=this,Error.call(t),t.stack=(new Error).stack,this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map(function(e,t){return t+1+") "+e.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e}).prototype=Object.create(Error.prototype),a.prototype.constructor=a,a);function u(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var l=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var e,t,n,a,u;if(!this.closed){this.closed=!0;var l=this._parentage;if(l)if(this._parentage=null,Array.isArray(l))try{for(var f=r(l),h=f.next();!h.done;h=f.next())h.value.remove(this)}catch(t){e={error:t}}finally{try{h&&!h.done&&(t=f.return)&&t.call(f)}finally{if(e)throw e.error}}else l.remove(this);var p=this.initialTeardown;if(s(p))try{p()}catch(e){u=e instanceof c?e.errors:[e]}var g=this._finalizers;if(g){this._finalizers=null;try{for(var m=r(g),y=m.next();!y.done;y=m.next()){var v=y.value;try{d(v)}catch(e){u=null!=u?u:[],e instanceof c?u=o(o([],i(u)),i(e.errors)):u.push(e)}}}catch(e){n={error:e}}finally{try{y&&!y.done&&(a=m.return)&&a.call(m)}finally{if(n)throw n.error}}}if(u)throw new c(u)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)d(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&u(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&u(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}();function f(e){return e instanceof l||e&&"closed"in e&&s(e.remove)&&s(e.add)&&s(e.unsubscribe)}function d(e){s(e)?e():e.unsubscribe()}l.EMPTY;var h=null,p=null,g=void 0,m=!1,y=!1,v={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var s=v.delegate;return(null==s?void 0:s.setTimeout)?s.setTimeout.apply(s,o([e,t],i(n))):setTimeout.apply(void 0,o([e,t],i(n)))},clearTimeout:function(e){var t=v.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function b(){}var _=w("C",void 0,void 0);function w(e,t,n){return{kind:e,value:t,error:n}}var E=null,x=function(e){function n(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,f(t)&&t.add(n)):n.destination=I,n}return t(n,e),n.create=function(e,t,n){return new R(e,t,n)},n.prototype.next=function(e){this.isStopped?T(function(e){return w("N",e,void 0)}(e),this):this._next(e)},n.prototype.error=function(e){this.isStopped?T(w("E",void 0,e),this):(this.isStopped=!0,this._error(e))},n.prototype.complete=function(){this.isStopped?T(_,this):(this.isStopped=!0,this._complete())},n.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},n.prototype._next=function(e){this.destination.next(e)},n.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},n.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},n}(l),k=Function.prototype.bind;function S(e,t){return k.call(e,t)}var C=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){O(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){O(e)}else O(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){O(e)}},e}(),R=function(e){function n(t,n,r){var i,o,a=e.call(this)||this;return s(t)||!t?i={next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=r?r:void 0}:a&&y?((o=Object.create(t)).unsubscribe=function(){return a.unsubscribe()},i={next:t.next&&S(t.next,o),error:t.error&&S(t.error,o),complete:t.complete&&S(t.complete,o)}):i=t,a.destination=new C(i),a}return t(n,e),n}(x);function O(e){var t;m?(t=e,m&&E&&(E.errorThrown=!0,E.error=t)):function(e){v.setTimeout(function(){if(!h)throw e;h(e)})}(e)}function T(e,t){var n=p;n&&v.setTimeout(function(){return n(e,t)})}var I={closed:!0,next:b,error:function(e){throw e},complete:b};function A(e,t,n,r,i){return new D(e,t,n,r,i)}var D=function(e){function n(t,n,r,i,o,s){var a=e.call(this,t)||this;return a.onFinalize=o,a.shouldUnsubscribe=s,a._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,a._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,a._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,a}return t(n,e),n.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},n}(x);function $(e){return function(t){if(function(e){return s(null==e?void 0:e.lift)}(t))return t.lift(function(t){try{return e(t,this)}catch(e){this.error(e)}});throw new TypeError("Unable to lift unknown Observable type")}}function L(e,t){return $(function(e,t,n){return function(r,i){var o=n,s=t,a=0;r.subscribe(A(i,function(t){var n=a++;s=o?e(s,t,n):(o=!0,t)},function(){o&&i.next(s),i.complete()}))}}(e,t,arguments.length>=2))}var M=function(e,t){return e.push(t),e};function F(){return $(function(e,t){L(M,[])(e).subscribe(t)})}function P(e){return e}function j(e,t,n){var r=s(e)||t||n?{next:e,error:t,complete:n}:e;return r?$(function(e,t){var n;null===(n=r.subscribe)||void 0===n||n.call(r);var i=!0;e.subscribe(A(t,function(e){var n;null===(n=r.next)||void 0===n||n.call(r,e),t.next(e)},function(){var e;i=!1,null===(e=r.complete)||void 0===e||e.call(r),t.complete()},function(e){var n;i=!1,null===(n=r.error)||void 0===n||n.call(r,e),t.error(e)},function(){var e,t;i&&(null===(e=r.unsubscribe)||void 0===e||e.call(r)),null===(t=r.finalize)||void 0===t||t.call(r)}))}):P}var B="function"==typeof Symbol&&Symbol.observable||"@@observable";var N=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r,i=this,o=(r=e)&&r instanceof x||function(e){return e&&s(e.next)&&s(e.error)&&s(e.complete)}(r)&&f(r)?e:new R(e,t,n);return function(e){if(m){var t=!E;if(t&&(E={errorThrown:!1,error:null}),e(),t){var n=E,r=n.errorThrown,i=n.error;if(E=null,r)throw i}}else e()}(function(){var e=i,t=e.operator,n=e.source;o.add(t?t.call(o,n):n?i._subscribe(o):i._trySubscribe(o))}),o},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=U(t))(function(t,r){var i=new R({next:function(t){try{e(t)}catch(e){r(e),i.unsubscribe()}},error:r,complete:t});n.subscribe(i)})},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[B]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0===(n=e).length?P:1===n.length?n[0]:function(e){return n.reduce(function(e,t){return t(e)},e)})(this);var n},e.prototype.toPromise=function(e){var t=this;return new(e=U(e))(function(e,n){var r;t.subscribe(function(e){return r=e},function(e){return n(e)},function(){return e(r)})})},e.create=function(t){return new e(t)},e}();function U(e){var t;return null!==(t=null!=e?e:g)&&void 0!==t?t:Promise}function z(e){return new N(t=>{Excel.run(async n=>{const r=n.workbook.names.getItem(e).getRange().getUsedRange();r.load("values");try{await n.sync()}catch(t){throw console.error("Error getting range named '"+e+"':",t),t}r.values&&r.values.length>0&&r.values[0].length>0?r.values.flat().filter((e,t,n)=>""!==e&&n.indexOf(e)===t).forEach(e=>t.next(e)):t.next("Named range is empty or does not exist"),t.complete()}).catch(e=>t.error(e))})}function H(e){return new N(t=>{Excel.run(async n=>{const r=n.workbook.tables.getItem(e),i=r.getHeaderRowRange().load("values"),o=r.getDataBodyRange().load("values");try{await n.sync()}catch(t){throw console.error("Error getting rows for table '"+e+"':",t),t}const s=i.values[0];o.values.forEach(e=>{const n=s.reduce((t,n,r)=>(t[n]=e[r],t),{});t.next(n)}),t.complete()}).catch(e=>t.error(e))})}async function q(e,t){try{if(0===t.length)return void console.warn("No data to write to table '"+e+"'.");await Excel.run(async n=>{const r=n.workbook.tables.getItemOrNullObject(e);if(await n.sync(),r.isNullObject)throw new Error(`Table "${e}" not found.`);r.rows.add(null,t),await n.sync()})}catch(n){throw console.error("Error writing to table:",n),console.error("Could not add data to table '"+e+"':",t),n}}async function Y(){return new Promise((e,t)=>{z("Expenses").pipe(F(),j(t=>e(t))).subscribe({error(e){t(e)}})})}async function K(){return new Promise((e,t)=>{H("Transactions").pipe(F(),j(t=>e(t))).subscribe({error:e=>t(e)})})}async function W(){return new Promise((e,t)=>{H("Rollovers").pipe(F()).subscribe({next:t=>e(t),error:e=>t(e)})})}async function Q(){return new Promise((e,t)=>{H("ExpenseData").pipe(F(),j(t=>e(t))).subscribe({error(e){t(e)}})})}async function J(){return new Promise((e,t)=>{H("BudgetHistory").pipe(F(),j(t=>e(t))).subscribe({error(e){t(e)}})})}var Z=n(44809),G=n.n(Z);class X{static fromCsv(e){const t=G().parse(e,{header:!0}).data;return t.forEach(async e=>{e["Description 1"]?(e.id=await async function(e){const t=function(e){return(new TextEncoder).encode(`\n    ${e["Transaction Date"]}\n    ${e["Account Number"]}\n    ${e["Description 1"]}\n    ${e["Description 2"]}\n    ${e.CAD$}\n    ${e.USD$}\n  `)}(e),n=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map(e=>e.toString(16).padStart(2,"0")).join("")}(e),e["Transaction Date"]=new Date(e["Transaction Date"]),e.Month=e["Transaction Date"].getMonth()+1,e.Year=e["Transaction Date"].getFullYear(),e.Date=e["Transaction Date"].toLocaleDateString(),e.CAD$=e.CAD$?parseFloat(e.CAD$.toString()):null,e.USD$=e.USD$?parseFloat(e.USD$.toString()):null,e.Amount=e.USD$||e.CAD$||0,e.Description=e["Description 1"]+" "+e["Description 2"]):t.splice(t.indexOf(e),1)}),t}}async function V(e){var t=X.fromCsv(e);console.log("Incoming Transactions:",t);const n=await Y();console.log("Expenses:",n);const r=await async function(){return new Promise((e,t)=>{H("MatchingRules").pipe(F()).subscribe({next:t=>e(t),error:e=>t(e)})})}();console.log("Matching Rules:",r);const i=await async function(){return new Promise((e,t)=>{H("AmbiguousItems").pipe(F()).subscribe({next:t=>e(t),error:e=>t(e)})})}();console.log("Ambiguous Items:",i);const o=await async function(){return new Promise((e,t)=>{var n;H("Accounts").pipe((n=e=>{var t={};return t[e.Number]=e.Name,t},$(function(e,t){var r=0;e.subscribe(A(t,function(e){t.next(n.call(void 0,e,r++))}))})),L((e,t)=>({...e,...t}),{})).subscribe({next:t=>e(t),error:e=>t(e)})})}();console.log("accountNames:",o);const s=await async function(){return new Promise((e,t)=>{z("TransactionIds").pipe(F(),j(t=>e(t))).subscribe({error(e){t(e)}})})}(),a=[],c=new Map,u=new Array;return r.forEach(e=>{const t=`${e["Match 1"]}${e["Match 2"]}`;c.set(t,e["Expense Type"]),e["Match 2"]||u.push({match:e["Match 1"],expense:e["Expense Type"]})}),t.forEach(e=>{if(e.id&&s.includes(e.id))return;if(a.push(e),e["Account Name"]=o[e["Account Number"]],e.Account=`${e["Account Name"]} (${e["Account Number"].slice(-4)})`,i.some(t=>e["Description 1"].toLowerCase().includes(t.Item.toLowerCase())))return console.warn("Transaction flagged as ambiguous:",e["Description 1"]),void(e.Expense="Ambiguous");let t=c.get(`${e["Description 1"]}${e["Description 2"]}`);if(t)e.Expense=t;else{for(let t of u)if(e["Description 1"].toLowerCase().includes(t.match.toLowerCase()))return void(e.Expense=t.expense);console.warn("No match found for transaction:",e["Description 1"],e["Description 2"])}}),console.log("New Transactions:",a),a.map(e=>[e.id,e.Month,e.Year,e.Date,e.Account,e.Expense,e.Amount,e.Description,e.Memo])}function ee(e,t){const n=document.getElementById("error-container"),r=document.getElementById("error-content"),i=document.getElementById("error-details");if(!n||!r||!i)return console.error("Error UI elements not found. Logging to console only."),void console.error(`[${t}]`,e);const o=`--- ERROR REPORT ---\nContext: ${t}\nTime: ${(new Date).toISOString()}\nMessage: ${e instanceof Error?e.message:String(e)}\n\nStack Trace:\n${e instanceof Error?e.stack:"No stack trace available"}\n--------------------`;i.textContent=o,n.style.display="block",console.error(`[${t}]`,e)}function te(){const e=document.getElementById("error-details");e&&navigator.clipboard.writeText(e.textContent||"").then(()=>{const e=document.getElementById("error-copy-btn");if(e){const t=e.textContent;e.textContent="Copied!",setTimeout(()=>e.textContent=t,2e3)}}).catch(e=>{console.error("Failed to copy error: ",e)})}function ne(){const e=document.getElementById("error-container");e&&(e.style.display="none")}function re(e,t="info"){const n=document.getElementById("console-output");if(n){const r=document.createElement("div");r.className=`log-entry ${t}`,r.textContent=`> ${e}`,n.appendChild(r),n.scrollTop=n.scrollHeight}}function ie(){const e=document.getElementById("console-output");e&&(e.innerHTML="",re("Console cleared."))}function oe(e){e.preventDefault(),e.stopPropagation()}function se(e){var t=e.dataTransfer.files;if(t.length>0){var n=t[0];re(`Reading file: ${n.name}...`,"info");var r=new FileReader;r.onload=ae,r.readAsText(n)}}async function ae(e){try{var t=e.target.result;re("Processing transactions...","info");const n=await V(t);await q("Transactions",n),re(`Successfully imported ${n.length} transactions.`,"success")}catch(e){ee(e,"ProcessFileDrop"),re("Failed to process file.","error")}}async function ce(e,t,n=null){let r;r=n?[n]:await Y();let i=new Date,o=i.getMonth()+1,s=i.getFullYear();const[a,c,u,l]=await Promise.all([W(),K(),Q(),J()]),f=new Map;a.forEach((e,t)=>{const n=`${e.Month}-${e.Year}-${e.Expense}`;f.set(n,{entry:e,index:t})});const d=new Map;c.forEach(e=>{const t=`${e.Month}-${e.Year}-${e["Expense Type"]}`,n=d.get(t)||0;d.set(t,n+(e.Amount||0))});const h=new Map;u.forEach(e=>{h.set(e["Expense Type"],{Budget:parseFloat(e.Budget||0),Init:parseFloat(e.Init||0)})});const p=[],g=[],m=(e,t,n)=>{const r=l.find(r=>r.Expense===e&&r["Month Start"]<=t&&t<=r["Month End"]&&r["Year Start"]<=n&&n<=r["Year End"]);return r?parseFloat(r.Amount):h.get(e)?.Budget||0},y=e=>h.get(e)?.Init||0;for(const n of r){let r=24,i=e,a=t;if(a>s||a===s&&i>o)return void console.error("Cannot reset rollover for a future date.");for(;(a<s||a===s&&i<=o)&&r>0;){const e=`${i}-${a}-${n}`;let t=f.get(e),o=t?{...t.entry}:null;const s=m(n,i,a);let c=i-1,u=a;0===c&&(c=12,u--);const l=`${c}-${u}-${n}`,h=f.get(l);let v=0;v=h?h.entry.EOM:y(n);const b=d.get(`${i}-${a}-${n}`)||0;o||(o={Month:i,Year:a,Expense:n,Expenses:0,BOM:0,EOM:0}),o.Expenses=b,o.BOM=v,o.EOM=o.BOM+s+b,t?(t.entry=o,p.push({rowIndex:t.index,data:o})):(g.push(o),f.set(e,{entry:o,index:-1})),i++,13===i&&(i=1,a++),r--}}if(p.length>0&&await async function(e,t){0!==t.length&&await Excel.run(async e=>{const n=e.workbook.tables.getItem("Rollovers"),r=n.getHeaderRowRange().load("values");await e.sync();const i=r.values[0];t.forEach(e=>{const t=n.getDataBodyRange().getRow(e.rowIndex),r=i.map(t=>e.data[t]??null);t.values=[r]}),await e.sync()}).catch(e=>{throw console.error("Error updating rows in table:",e),e})}(0,p),g.length>0){const e=g.map(e=>[e.Month,e.Year,e.Expense,e.Expenses,e.BOM,e.EOM]);await q("Rollovers",e)}await async function(e){return async function(e,t){await Excel.run(async n=>{let r=n.workbook.names.getItemOrNullObject(e);await n.sync(),r.isNullObject&&(console.warn(`Named range '${e}' not found. Creating it at Rollovers!H1.`),r=n.workbook.names.add(e,"Rollovers!H1")),r.getRange().values=[[t]],await n.sync()}).catch(t=>{throw console.error(`Error setting named range '${e}':`,t),t})}("LastRolloverUpdate",e.toISOString().split("T")[0])}(new Date)}async function ue(){try{const e=await async function(){return new Promise((e,t)=>{z("LastRolloverUpdate").pipe(F(),j(t=>{t.length>0&&t[0]?e(new Date(t[0])):e(null)})).subscribe({error(t){console.warn("Could not fetch LastRolloverUpdate:",t),e(null)}})})}(),t=document.getElementById("last-updated");e?(t.textContent=`Synced: ${e.toISOString().split("T")[0]}`,document.getElementById("month-input").value=(e.getMonth()+1).toString(),document.getElementById("year-input").value=e.getFullYear().toString(),re(`Last sync found: ${e.toLocaleDateString()}`,"info")):(t.textContent="Synced: Never",re("No previous sync date found.","warn"))}catch(e){console.error("Error fetching last update:",e)}}async function le(){try{re("Starting rollover recalculation...","info");var e=parseInt(document.getElementById("month-input").value),t=parseInt(document.getElementById("year-input").value);let n=document.getElementById("expense-dropdown"),r=n.options[n.selectedIndex].text;"All Expenses"===r&&(r=null),await Excel.run(async n=>{await ce(e,t,r),await n.sync()}),re("Recalculation complete.","success"),await ue()}catch(e){ee(e,"TriggerResetRollovers"),re("Error during recalculation.","error")}}Office.onReady(e=>{if(e.host===Office.HostType.Excel){document.getElementById("error-close-btn").addEventListener("click",ne),document.getElementById("error-copy-btn").addEventListener("click",te),document.getElementById("clear-console").addEventListener("click",ie);const e=new Date;document.getElementById("month-input").value=(e.getMonth()+1).toString(),document.getElementById("year-input").value=e.getFullYear().toString();let t=document.getElementById("drop-area");["dragenter","dragover","dragleave","drop"].forEach(e=>{t.addEventListener(e,oe,!1)}),["dragenter","dragover"].forEach(e=>{t.addEventListener(e,e=>{t.classList.add("highlight")},!1)}),["dragleave","drop"].forEach(e=>{t.addEventListener(e,e=>{t.classList.remove("highlight")},!1)}),t.addEventListener("drop",se,!1),document.getElementById("reset").onclick=le,window.onload=async()=>{re("Initializing..."),await async function(){try{await async function(e,t,n=e){await Excel.run(async r=>{const i=r.workbook.tables.getItemOrNullObject(e);if(await r.sync(),!i.isNullObject)return;console.log(`Table '${e}' not found. Creating it...`);let o=r.workbook.worksheets.getItemOrNullObject(n);await r.sync(),o.isNullObject&&(console.log(`Sheet '${n}' not found. Creating it...`),o=r.workbook.worksheets.add(n));const s=`A1:${String.fromCharCode("A".charCodeAt(0)+t.length-1)}1`,a=o.tables.add(s,!0);a.name=e,a.getHeaderRowRange().values=[t],await r.sync(),console.log(`Table '${e}' created successfully.`)}).catch(t=>{throw console.error(`Error ensuring table '${e}' exists:`,t),t})}("AmbiguousItems",["Item","IsAmbiguous","OverrideCount","Confidence"])}catch(e){console.error("Schema initialization failed:",e)}}(),await async function(){try{const e=await Y(),t=document.getElementById("expense-dropdown");t.innerHTML='<option value="">All Expenses</option>';for(const n of e){const e=document.createElement("option");e.value=e.text=n,t.add(e)}re(`Loaded ${e.length} expense categories.`,"info")}catch(e){ee(e,"populateExpenseDropdown")}}(),await ue(),re("Ready.")}}})}(),function(){"use strict";var e=n(14385),t=n.n(e),r=new URL(n(58394),n.b);t()(r)}()}();
//# sourceMappingURL=taskpane.js.map